# Fleet bundle: Traefik Ingress Controller (Helm)
#
# Installs Traefik into the `traefik` namespace and exposes it as a LoadBalancer.
# This is intended as a prerequisite for the retail demo bundle in `fleet/retail/`.

namespace: traefik

helm:
  releaseName: traefik
  repo: https://helm.traefik.io/traefik
  chart: traefik
  # Pin a version for demo repeatability. Update as needed.
  version: 28.3.0
  values:
    service:
      type: LoadBalancer

    # IMPORTANT for Rancher/Fleet GitRepo configs that set a targetNamespace:
    # cluster-scoped resources may be forbidden. Namespaced RBAC avoids ClusterRole/ClusterRoleBinding.
    rbac:
      namespaced: true

    # Watch the namespaces used by this demo.
    # When rbac.namespaced=true, Traefik watches the release namespace plus the namespaces listed here.
    providers:
      kubernetesIngress:
        namespaces:
          - retail
      kubernetesCRD:
        namespaces:
          - retail

    ingressClass:
      enabled: true
      isDefaultClass: false
      name: traefik
